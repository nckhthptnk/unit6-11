<!doctype html>
<html lang="vi">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Unit 6: Social Issues</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        html {
            height: 100%;
        }
        
        .flashcard {
            perspective: 1000px;
            cursor: pointer;
            height: 400px;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        
        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }
        
        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 16px;
            padding: 32px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            text-align: center;
        }
        
        .flashcard-back {
            transform: rotateY(180deg);
        }
        
        .highlight {
            background-color: #fef08a;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
            color: #92400e;
        }
        
        .vocab-highlight {
            background-color: #fef08a;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 700;
            color: #92400e;
            border: 2px solid #f59e0b;
            box-shadow: 0 2px 4px rgba(245, 158, 11, 0.3);
            transition: all 0.3s ease;
        }
        
        .vocab-highlight:hover {
            background-color: #fde047;
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(245, 158, 11, 0.4);
        }
        
        .quiz-option {
            transition: all 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .quiz-option:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .quiz-option.correct {
            background-color: #86efac !important;
            border-color: #22c55e !important;
            color: #166534 !important;
        }
        
        .quiz-option.incorrect {
            background-color: #fca5a5 !important;
            border-color: #ef4444 !important;
            color: #991b1b !important;
        }
        
        .progress-bar {
            transition: width 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease;
        }
        
        .grammar-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .grammar-content.active {
            max-height: 2000px;
        }
        
        .tab-button {
            transition: all 0.3s;
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .vocab-mode-btn {
            transition: all 0.3s;
        }
        
        .vocab-mode-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .vocab-mode-btn:not(.active) {
            background-color: #6b7280;
        }
        
        .vocab-mode-btn:not(.active):hover {
            background-color: #4b5563;
        }
        
        .vocab-test-question {
            transition: all 0.3s;
        }
        
        .vocab-test-option {
            transition: all 0.3s;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .vocab-test-option:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .vocab-test-option.correct {
            background-color: #86efac !important;
            border-color: #22c55e !important;
            color: #166534 !important;
        }
        
        .vocab-test-option.incorrect {
            background-color: #fca5a5 !important;
            border-color: #ef4444 !important;
            color: #991b1b !important;
        }
        
        .vocab-test-option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .control-button {
            transition: all 0.2s;
        }
        
        .control-button:hover {
            transform: scale(1.05);
        }
        
        .control-button:active {
            transform: scale(0.95);
        }
        
        .reading-text {
            line-height: 1.8;
            font-size: 1.1rem;
        }
        
        .grammar-theory {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-left: 4px solid #667eea;
        }
        
        .progress-circle {
            transform: rotate(-90deg);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 0 12px;
            }
            
            .flashcard {
                height: 300px;
                max-width: 100%;
                margin: 0 8px;
            }
            
            .flashcard-front, .flashcard-back {
                padding: 16px;
            }
            
            .flashcard-front h2 {
                font-size: 2rem !important;
            }
            
            .flashcard-front p {
                font-size: 1rem !important;
            }
            
            .flashcard-back h3 {
                font-size: 1.5rem !important;
            }
            
            .flashcard-back div {
                font-size: 0.9rem !important;
            }
            
            .reading-text {
                font-size: 0.95rem;
                line-height: 1.6;
            }
            
            .tab-button {
                padding: 12px 16px;
                font-size: 0.9rem;
            }
            
            .vocab-mode-btn {
                padding: 12px 16px;
                font-size: 0.9rem;
            }
            
            .control-button {
                padding: 12px 16px;
                font-size: 0.9rem;
            }
            
            .grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3 {
                grid-template-columns: 1fr;
            }
            
            .grid-cols-2.md\\:grid-cols-4 {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }
            
            .progress-circle svg {
                width: 60px;
                height: 60px;
            }
            
            .progress-circle circle {
                r: 26;
                cx: 30;
                cy: 30;
                stroke-dasharray: 163;
            }
            
            .quiz-option, .vocab-test-option {
                padding: 12px;
                font-size: 0.9rem;
            }
            
            .grammar-theory {
                padding: 16px;
            }
            
            .vocab-test-question {
                padding: 16px;
            }
            
            .flex.flex-col.sm\\:flex-row.justify-center.gap-4 {
                gap: 12px;
            }
            
            .flex.flex-col.sm\\:flex-row.justify-center.gap-4 .vocab-mode-btn {
                width: 100%;
            }
            
            .flex.justify-center.items-center.gap-4 {
                flex-wrap: wrap;
                gap: 12px;
            }
            
            .text-4xl {
                font-size: 2rem !important;
            }
            
            .text-2xl {
                font-size: 1.5rem !important;
            }
            
            .text-xl {
                font-size: 1.25rem !important;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 0 8px;
            }
            
            .flashcard {
                height: 280px;
                margin: 0 4px;
            }
            
            .flashcard-front, .flashcard-back {
                padding: 12px;
            }
            
            .flashcard-front h2 {
                font-size: 1.75rem !important;
            }
            
            .flashcard-front p {
                font-size: 0.9rem !important;
            }
            
            .flashcard-back h3 {
                font-size: 1.25rem !important;
            }
            
            .flashcard-back div {
                font-size: 0.85rem !important;
            }
            
            .tab-button {
                padding: 10px 12px;
                font-size: 0.85rem;
            }
            
            .vocab-mode-btn {
                padding: 10px 12px;
                font-size: 0.85rem;
            }
            
            .control-button {
                padding: 10px 12px;
                font-size: 0.85rem;
            }
            
            .grid-cols-2.md\\:grid-cols-4 {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .progress-circle svg {
                width: 50px;
                height: 50px;
            }
            
            .progress-circle circle {
                r: 22;
                cx: 25;
                cy: 25;
                stroke-dasharray: 138;
            }
            
            .progress-circle .text-lg {
                font-size: 0.9rem !important;
            }
            
            .reading-text {
                font-size: 0.9rem;
                line-height: 1.5;
            }
            
            .quiz-option, .vocab-test-option {
                padding: 10px;
                font-size: 0.85rem;
            }
            
            .grammar-theory {
                padding: 12px;
            }
            
            .vocab-test-question {
                padding: 12px;
            }
            
            .text-4xl {
                font-size: 1.75rem !important;
            }
            
            .text-2xl {
                font-size: 1.25rem !important;
            }
            
            .text-xl {
                font-size: 1.1rem !important;
            }
            
            .bg-white.rounded-xl.shadow-lg.p-6 {
                padding: 16px !important;
            }
            
            .p-6 {
                padding: 16px !important;
            }
            
            .mb-8 {
                margin-bottom: 24px !important;
            }
            
            .mb-6 {
                margin-bottom: 20px !important;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-full">
  <div class="container mx-auto px-4 py-6 max-w-6xl"><!-- Header -->
   <div class="text-center mb-8">
    <div class="flex flex-col md:flex-row justify-between items-center mb-4 gap-4"><button onclick="goHome()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-all duration-200 flex items-center gap-2 order-2 md:order-1">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
      </svg> Trang ch·ªß </button>
     <h1 id="unit-title" class="text-4xl font-bold text-gray-800 order-1 md:order-2">Unit 6: Social Issues</h1>
     <div class="w-20 hidden md:block order-3"></div>
    </div>
   </div><!-- Progress Section -->
   <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
    <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Ti·∫øn ƒë·ªô h·ªçc t·∫≠p</h2>
    <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
     <div class="text-center">
      <div class="relative w-20 h-20 mx-auto mb-3">
       <svg class="w-20 h-20 progress-circle"><circle cx="40" cy="40" r="36" stroke="#e5e7eb" stroke-width="8" fill="none"></circle> <circle id="total-progress-circle" cx="40" cy="40" r="36" stroke="#3b82f6" stroke-width="8" fill="none" stroke-dasharray="226" stroke-dashoffset="226"></circle>
       </svg>
       <div class="absolute inset-0 flex items-center justify-center"><span id="total-progress" class="text-lg font-bold text-blue-600">0%</span>
       </div>
      </div>
      <p class="font-semibold text-gray-700">T·ªïng</p>
     </div>
     <div class="text-center">
      <div class="relative w-20 h-20 mx-auto mb-3">
       <svg class="w-20 h-20 progress-circle"><circle cx="40" cy="40" r="36" stroke="#e5e7eb" stroke-width="8" fill="none"></circle> <circle id="vocab-progress-circle" cx="40" cy="40" r="36" stroke="#10b981" stroke-width="8" fill="none" stroke-dasharray="226" stroke-dashoffset="226"></circle>
       </svg>
       <div class="absolute inset-0 flex items-center justify-center"><span id="vocab-progress" class="text-lg font-bold text-green-600">0%</span>
       </div>
      </div>
      <p class="font-semibold text-gray-700">T·ª´ v·ª±ng</p>
     </div>
     <div class="text-center">
      <div class="relative w-20 h-20 mx-auto mb-3">
       <svg class="w-20 h-20 progress-circle"><circle cx="40" cy="40" r="36" stroke="#e5e7eb" stroke-width="8" fill="none"></circle> <circle id="reading-progress-circle" cx="40" cy="40" r="36" stroke="#f59e0b" stroke-width="8" fill="none" stroke-dasharray="226" stroke-dashoffset="226"></circle>
       </svg>
       <div class="absolute inset-0 flex items-center justify-center"><span id="reading-progress" class="text-lg font-bold text-yellow-600">0%</span>
       </div>
      </div>
      <p class="font-semibold text-gray-700">B√†i ƒë·ªçc</p>
     </div>
     <div class="text-center">
      <div class="relative w-20 h-20 mx-auto mb-3">
       <svg class="w-20 h-20 progress-circle"><circle cx="40" cy="40" r="36" stroke="#e5e7eb" stroke-width="8" fill="none"></circle> <circle id="grammar-progress-circle" cx="40" cy="40" r="36" stroke="#8b5cf6" stroke-width="8" fill="none" stroke-dasharray="226" stroke-dashoffset="226"></circle>
       </svg>
       <div class="absolute inset-0 flex items-center justify-center"><span id="grammar-progress" class="text-lg font-bold text-purple-600">0%</span>
       </div>
      </div>
      <p class="font-semibold text-gray-700">Ng·ªØ ph√°p</p>
     </div>
    </div>
   </div><!-- Content Selection Tabs -->
   <div class="bg-white rounded-xl shadow-lg mb-8">
    <div class="flex flex-col sm:flex-row justify-center border-b"><button onclick="showSection('vocabulary')" class="tab-button px-6 py-4 font-semibold text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 active flex-1 sm:flex-none" id="vocab-tab"> T·ª´ v·ª±ng </button> <button onclick="showSection('reading')" class="tab-button px-6 py-4 font-semibold text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 flex-1 sm:flex-none" id="reading-tab"> B√†i ƒë·ªçc </button> <button onclick="showSection('grammar')" class="tab-button px-6 py-4 font-semibold text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 flex-1 sm:flex-none" id="grammar-tab"> Ng·ªØ ph√°p </button> <button onclick="showSection('social-issues')" class="tab-button px-6 py-4 font-semibold text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 flex-1 sm:flex-none" id="social-issues-tab"> Social Issues </button>
    </div><!-- Vocabulary Section -->
    <div id="vocabulary-section" class="p-6"><!-- Navigation buttons -->
     <div class="flex flex-col sm:flex-row justify-center gap-4 mb-6"><button onclick="showVocabMode('flashcard')" id="flashcard-btn" class="vocab-mode-btn bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 w-full sm:w-auto"> H·ªçc Flashcard </button> <button onclick="showVocabMode('test')" id="test-btn" class="vocab-mode-btn bg-gray-500 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200 w-full sm:w-auto"> Ki·ªÉm tra tr·∫Øc nghi·ªám </button>
     </div><!-- Flashcard Mode -->
     <div id="flashcard-mode">
      <div class="text-center mb-6">
       <h3 class="text-2xl font-bold text-gray-800 mb-2">H·ªçc t·ª´ v·ª±ng v·ªõi Flashcard</h3>
       <p class="text-gray-600">Nh·∫•n Space ƒë·ªÉ l·∫≠t th·∫ª, ‚Üê ƒë·ªÉ l√πi, ‚Üí ƒë·ªÉ ti·∫øp t·ª•c</p>
      </div>
      <div class="flashcard" id="flashcard" onclick="flipCard()">
       <div class="flashcard-inner" id="flashcard-inner">
        <div class="flashcard-front" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
         <h2 id="word-front" class="text-4xl font-bold text-white mb-4">poverty</h2>
         <p id="pronunciation" class="text-xl text-white opacity-90">/Ààp…ív…ôti/</p>
         <p id="word-type" class="text-lg text-white opacity-80 mt-2">(noun)</p><button onclick="event.stopPropagation(); speakWord(vocabularyData[currentCardIndex].word);" class="mt-4 bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-4 py-2 rounded-lg transition-all duration-200 flex items-center gap-2 mx-auto">
          <svg class="w-5 h-5" fill="currentColor" viewbox="0 0 20 20"><path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.776l-4.146-3.32a1 1 0 00-.632-.227H2a1 1 0 01-1-1V7.771a1 1 0 011-1h1.605a1 1 0 00.632-.227l4.146-3.32a1 1 0 011.617.776zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.983 5.983 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.984 3.984 0 00-1.172-2.828 1 1 0 010-1.415z" clip-rule="evenodd"></path>
          </svg> Ph√°t √¢m </button>
        </div>
        <div class="flashcard-back" style="background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);">
         <h3 id="word-meaning" class="text-2xl font-bold text-white mb-4">s·ª± ngh√®o ƒë√≥i</h3>
         <div id="word-example" class="text-lg text-white opacity-90 italic text-center">
          "Many families live in <span class="highlight">poverty</span> and struggle to meet basic needs."
         </div>
        </div>
       </div>
      </div>
      <div class="flex justify-center items-center gap-4 mt-8"><button onclick="previousCard()" class="control-button bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold"> ‚Üê L√πi </button> <span id="card-counter" class="text-lg font-semibold text-gray-700">1 / 62</span> <button onclick="nextCard()" class="control-button bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold"> Ti·∫øp ‚Üí </button>
      </div>
     </div><!-- Vocabulary Test Mode -->
     <div id="test-mode" class="hidden">
      <div class="text-center mb-6">
       <h3 class="text-2xl font-bold text-gray-800 mb-2">Ki·ªÉm tra t·ª´ v·ª±ng</h3>
       <p class="text-gray-600">67 c√¢u tr·∫Øc nghi·ªám - Ch·ªçn ƒë√°p √°n ƒë√∫ng nh·∫•t</p>
       <div class="mt-4">
        <div class="bg-gray-200 rounded-full h-3 w-full max-w-md mx-auto">
         <div id="test-progress-bar" class="bg-blue-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
        </div>
        <p class="mt-2 text-sm text-gray-600"><span id="test-current">0</span> / <span id="test-total">67</span> c√¢u | ƒêi·ªÉm: <span id="test-score">0</span>/<span id="test-max-score">67</span></p>
       </div>
      </div>
      <div id="vocab-test-container" class="space-y-6"><!-- Test questions will be generated here -->
      </div>
      <div class="text-center mt-8">
       <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
        <p class="text-blue-800 font-medium">üí° <strong>B·∫°n h√£y tr·∫£ l·ªùi h·∫øt c√¢u tr·∫Øc nghi·ªám ƒë·ªÉ ho√†n th√†nh ti·∫øn ƒë·ªô h·ªçc nh√©!</strong></p>
       </div><button onclick="resetVocabTest()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200"> L√†m l·∫°i b√†i ki·ªÉm tra </button>
      </div>
     </div>
    </div><!-- Reading Section -->
    <div id="reading-section" class="p-6 hidden"><!-- Reading Text Mode -->
     <div id="reading-text-mode">
      <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">B√†i ƒë·ªçc hi·ªÉu</h3>
      <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-8 mb-8 border-l-4 border-blue-500 shadow-lg">
       <div class="reading-text text-gray-800 leading-relaxed text-lg">
        <p class="mb-8 text-justify leading-loose">Social issues like <span class="vocab-highlight">poverty</span>, <span class="vocab-highlight">homelessness</span>, and <span class="vocab-highlight">unemployment</span> continue to challenge societies worldwide. These problems often create a cycle where families <span class="vocab-highlight">struggle</span> to meet basic needs, leading to increased stress and social instability. <u><strong>"Addressing these challenges"</strong></u> requires coordinated efforts from governments, <span class="vocab-highlight">non-profit organizations</span>, and communities working together. <strong>[I]</strong> Many <span class="vocab-highlight">charities</span> and volunteer groups <span class="vocab-highlight">focus on</span> providing immediate relief through food banks, shelters, and job training programs.</p>
        <p class="mb-8 text-justify leading-loose">Mental health issues, including <span class="vocab-highlight">depression</span> and anxiety, have become increasingly prevalent, particularly among young people. <strong>[II]</strong> Healthcare systems worldwide <span class="vocab-highlight">struggle</span> to provide <span class="vocab-highlight">affordable</span> mental health services to those in need. <u><strong>"Early intervention and community support"</strong></u> are essential for preventing more serious mental health <span class="vocab-highlight">crises</span>. Social stigma often prevents people from seeking help, making it crucial to raise awareness and promote understanding.</p>
        <p class="mb-8 text-justify leading-loose">Environmental problems like climate change and <span class="vocab-highlight">pollution</span> disproportionately affect vulnerable populations. <strong>[III]</strong> Poor communities often lack resources to <u><strong>"adapt to environmental changes"</strong></u> or relocate when necessary. Governments must <span class="vocab-highlight">invest</span> in sustainable solutions while ensuring that environmental policies don't worsen existing inequalities.</p>
        <p class="mb-8 text-justify leading-loose"><strong>[IV]</strong> Successful social programs require long-term commitment and adequate funding to create lasting change in communities. Education plays a crucial role in breaking the cycle of <span class="vocab-highlight">poverty</span> by providing people with skills and opportunities for better employment. <span class="vocab-highlight">Non-profit organizations</span> and government agencies must work together to address root causes rather than just treating symptoms. <u><strong>"Sustainable development goals"</strong></u> can only be achieved through coordinated international <span class="vocab-highlight">efforts</span> and shared responsibility among all nations.</p>
       </div>
      </div>
      <div id="reading-quiz" class="space-y-4">
       <h4 class="text-xl font-bold text-gray-800 mb-4">C√¢u h·ªèi tr·∫Øc nghi·ªám</h4><!-- Quiz questions will be generated here -->
       <div class="text-center mt-8">
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
         <p class="text-blue-800 font-medium">üí° <strong>B·∫°n h√£y tr·∫£ l·ªùi h·∫øt c√¢u tr·∫Øc nghi·ªám ƒë·ªÉ ho√†n th√†nh ti·∫øn ƒë·ªô h·ªçc nh√©!</strong></p>
        </div>
       </div>
      </div>
     </div>
    </div><!-- Grammar Section -->
    <div id="grammar-section" class="p-6 hidden">
     <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">Ng·ªØ ph√°p</h3>
     <div class="space-y-4 mb-8"><button onclick="toggleGrammarContent('gerund')" class="w-full text-left bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white p-4 rounded-lg font-semibold transition-all duration-200"> GERUND (Danh ƒë·ªông t·ª´) </button>
      <div id="gerund-content" class="grammar-content grammar-theory p-6 rounded-lg">
       <h4 class="text-xl font-bold text-gray-800 mb-4">GERUND (Danh ƒë·ªông t·ª´)</h4>
       <div class="space-y-4 text-gray-700">
        <p><strong>ƒê·ªãnh nghƒ©a:</strong> Gerund l√† d·∫°ng V-ing c·ªßa ƒë·ªông t·ª´ ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ m·ªôt danh t·ª´.</p>
        <p><strong>C√°ch th√†nh l·∫≠p:</strong> Verb + ing</p>
        <p><strong>Ch·ª©c nƒÉng:</strong></p>
        <ul class="list-disc list-inside ml-4 space-y-2">
         <li><strong>L√†m ch·ªß ng·ªØ:</strong> Swimming is good for health.</li>
         <li><strong>L√†m t√¢n ng·ªØ:</strong> I enjoy reading books.</li>
         <li><strong>Sau gi·ªõi t·ª´:</strong> She is interested in learning English.</li>
         <li><strong>Sau m·ªôt s·ªë ƒë·ªông t·ª´:</strong> avoid, enjoy, finish, mind, suggest, etc.</li>
        </ul>
        <p><strong>V√≠ d·ª•:</strong></p>
        <ul class="list-disc list-inside ml-4 space-y-1">
         <li>Helping others makes me happy.</li>
         <li>They stopped talking when I entered.</li>
         <li>I'm thinking of changing my job.</li>
        </ul>
       </div>
      </div><button onclick="toggleGrammarContent('question-tags')" class="w-full text-left bg-gradient-to-r from-indigo-500 to-indigo-600 hover:from-indigo-600 hover:to-indigo-700 text-white p-4 rounded-lg font-semibold transition-all duration-200"> QUESTION TAGS (C√¢u h·ªèi ƒëu√¥i) </button>
      <div id="question-tags-content" class="grammar-content grammar-theory p-6 rounded-lg">
       <h4 class="text-xl font-bold text-gray-800 mb-4">QUESTION TAGS (C√¢u h·ªèi ƒëu√¥i)</h4>
       <div class="space-y-4 text-gray-700">
        <p><strong>ƒê·ªãnh nghƒ©a:</strong> Question tags l√† nh·ªØng c√¢u h·ªèi ng·∫Øn ƒë∆∞·ª£c th√™m v√†o cu·ªëi c√¢u ƒë·ªÉ x√°c nh·∫≠n th√¥ng tin.</p>
        <p><strong>Quy t·∫Øc c∆° b·∫£n:</strong></p>
        <ul class="list-disc list-inside ml-4 space-y-2">
         <li><strong>C√¢u kh·∫≥ng ƒë·ªãnh + question tag ph·ªß ƒë·ªãnh:</strong> You are a student, aren't you?</li>
         <li><strong>C√¢u ph·ªß ƒë·ªãnh + question tag kh·∫≥ng ƒë·ªãnh:</strong> You don't like coffee, do you?</li>
        </ul>
        <p><strong>V·ªõi ƒë·ªông t·ª´ TO BE:</strong></p>
        <ul class="list-disc list-inside ml-4 space-y-1">
         <li>She is beautiful, isn't she?</li>
         <li>They aren't ready, are they?</li>
        </ul>
        <p><strong>V·ªõi ƒë·ªông t·ª´ th∆∞·ªùng:</strong></p>
        <ul class="list-disc list-inside ml-4 space-y-1">
         <li>You like music, don't you?</li>
         <li>He doesn't work here, does he?</li>
        </ul>
        <p><strong>V·ªõi ƒë·ªông t·ª´ khuy·∫øt thi·∫øu:</strong></p>
        <ul class="list-disc list-inside ml-4 space-y-1">
         <li>You can swim, can't you?</li>
         <li>She won't come, will she?</li>
        </ul>
       </div>
      </div><button onclick="showGrammarQuiz()" class="w-full text-left bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white p-4 rounded-lg font-semibold transition-all duration-200"> B√†i t·∫≠p t·ªïng h·ª£p (30 c√¢u) </button>
     </div>
     <div id="grammar-quiz" class="hidden">
      <h4 class="text-xl font-bold text-gray-800 mb-4">B√†i t·∫≠p t·ªïng h·ª£p</h4>
      <div id="grammar-quiz-content"></div>
     </div>
    </div><!-- Social Issues Section -->
    <div id="social-issues-section" class="p-6 hidden">
     <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">C√°c v·∫•n ƒë·ªÅ x√£ h·ªôi tr·ªçng ƒëi·ªÉm</h3>
     <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><!-- Poverty -->
      <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
       <div class="bg-gradient-to-r from-red-500 to-red-600 p-4">
        <div class="flex items-center gap-3">
         <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center"><span class="text-2xl">üí∞</span>
         </div>
         <h4 class="text-xl font-bold text-white">Poverty</h4>
        </div>
       </div>
       <div class="p-6">
        <p class="text-gray-700 mb-4"><strong>Poverty</strong> - The state of lacking sufficient financial resources and basic necessities to maintain a minimum standard of living.</p>
        <ul class="text-sm text-gray-600 space-y-2">
         <li>‚Ä¢ Lack of food and clean water</li>
         <li>‚Ä¢ No stable housing or shelter</li>
         <li>‚Ä¢ Limited access to education and healthcare</li>
         <li>‚Ä¢ Affects over 700 million people globally</li>
        </ul>
       </div>
      </div><!-- Homelessness -->
      <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
       <div class="bg-gradient-to-r from-orange-500 to-orange-600 p-4">
        <div class="flex items-center gap-3">
         <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center"><span class="text-2xl">üè†</span>
         </div>
         <h4 class="text-xl font-bold text-white">Homelessness</h4>
        </div>
       </div>
       <div class="p-6">
        <p class="text-gray-700 mb-4"><strong>Homelessness</strong> - The condition of lacking stable, safe, and adequate housing.</p>
        <ul class="text-sm text-gray-600 space-y-2">
         <li>‚Ä¢ Living on streets or in temporary shelters</li>
         <li>‚Ä¢ Lack of security and safety</li>
         <li>‚Ä¢ Difficulty accessing social services</li>
         <li>‚Ä¢ Impacts physical and mental health</li>
        </ul>
       </div>
      </div><!-- Climate Change -->
      <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
       <div class="bg-gradient-to-r from-green-500 to-green-600 p-4">
        <div class="flex items-center gap-3">
         <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center"><span class="text-2xl">üåç</span>
         </div>
         <h4 class="text-xl font-bold text-white">Climate Change</h4>
        </div>
       </div>
       <div class="p-6">
        <p class="text-gray-700 mb-4"><strong>Climate Change</strong> - Long-term shifts in global climate patterns caused by human activities.</p>
        <ul class="text-sm text-gray-600 space-y-2">
         <li>‚Ä¢ Rising global temperatures</li>
         <li>‚Ä¢ Increasing extreme weather events</li>
         <li>‚Ä¢ Rising sea levels</li>
         <li>‚Ä¢ Impact on agriculture and ecosystems</li>
        </ul>
       </div>
      </div><!-- Mental Health -->
      <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
       <div class="bg-gradient-to-r from-purple-500 to-purple-600 p-4">
        <div class="flex items-center gap-3">
         <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center"><span class="text-2xl">üß†</span>
         </div>
         <h4 class="text-xl font-bold text-white">Mental Health Crisis</h4>
        </div>
       </div>
       <div class="p-6">
        <p class="text-gray-700 mb-4"><strong>Mental Health Crisis</strong> - The increasing prevalence of mental health issues in society.</p>
        <ul class="text-sm text-gray-600 space-y-2">
         <li>‚Ä¢ Rising rates of depression and anxiety</li>
         <li>‚Ä¢ Lack of mental health support services</li>
         <li>‚Ä¢ Social stigma around mental illness</li>
         <li>‚Ä¢ Impact on productivity and quality of life</li>
        </ul>
       </div>
      </div><!-- Digital Divide -->
      <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
       <div class="bg-gradient-to-r from-blue-500 to-blue-600 p-4">
        <div class="flex items-center gap-3">
         <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center"><span class="text-2xl">üíª</span>
         </div>
         <h4 class="text-xl font-bold text-white">Digital Divide</h4>
        </div>
       </div>
       <div class="p-6">
        <p class="text-gray-700 mb-4"><strong>Digital Divide</strong> - The gap between those who have access to modern technology and those who don't.</p>
        <ul class="text-sm text-gray-600 space-y-2">
         <li>‚Ä¢ Lack of internet and digital devices</li>
         <li>‚Ä¢ Limited digital literacy skills</li>
         <li>‚Ä¢ Impact on education and employment</li>
         <li>‚Ä¢ Increases social inequality</li>
        </ul>
       </div>
      </div><!-- Gender Inequality -->
      <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
       <div class="bg-gradient-to-r from-pink-500 to-pink-600 p-4">
        <div class="flex items-center gap-3">
         <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center"><span class="text-2xl">‚öñÔ∏è</span>
         </div>
         <h4 class="text-xl font-bold text-white">Gender Inequality</h4>
        </div>
       </div>
       <div class="p-6">
        <p class="text-gray-700 mb-4"><strong>Gender Inequality</strong> - Discrimination and unequal opportunities based on gender.</p>
        <ul class="text-sm text-gray-600 space-y-2">
         <li>‚Ä¢ Gender pay gap in the workplace</li>
         <li>‚Ä¢ Limited leadership opportunities for women</li>
         <li>‚Ä¢ Domestic violence and harassment</li>
         <li>‚Ä¢ Lack of reproductive rights and education</li>
        </ul>
       </div>
      </div><!-- Aging Population -->
      <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
       <div class="bg-gradient-to-r from-indigo-500 to-indigo-600 p-4">
        <div class="flex items-center gap-3">
         <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center"><span class="text-2xl">üë¥</span>
         </div>
         <h4 class="text-xl font-bold text-white">Aging Population</h4>
        </div>
       </div>
       <div class="p-6">
        <p class="text-gray-700 mb-4"><strong>Aging Population</strong> - The increasing proportion of elderly people in the population.</p>
        <ul class="text-sm text-gray-600 space-y-2">
         <li>‚Ä¢ Pressure on healthcare systems</li>
         <li>‚Ä¢ Shortage of young workforce</li>
         <li>‚Ä¢ Rising elderly care costs</li>
         <li>‚Ä¢ Need for pension system reforms</li>
        </ul>
       </div>
      </div><!-- Youth Unemployment -->
      <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
       <div class="bg-gradient-to-r from-yellow-500 to-yellow-600 p-4">
        <div class="flex items-center gap-3">
         <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center"><span class="text-2xl">üë®‚Äçüíº</span>
         </div>
         <h4 class="text-xl font-bold text-white">Youth Unemployment</h4>
        </div>
       </div>
       <div class="p-6">
        <p class="text-gray-700 mb-4"><strong>Youth Unemployment</strong> - High unemployment rates among people aged 15-24.</p>
        <ul class="text-sm text-gray-600 space-y-2">
         <li>‚Ä¢ Lack of experience and skills</li>
         <li>‚Ä¢ Mismatch between education and job market</li>
         <li>‚Ä¢ Impact on economic development</li>
         <li>‚Ä¢ Causes social instability</li>
        </ul>
       </div>
      </div><!-- Food Security -->
      <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
       <div class="bg-gradient-to-r from-teal-500 to-teal-600 p-4">
        <div class="flex items-center gap-3">
         <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center"><span class="text-2xl">üåæ</span>
         </div>
         <h4 class="text-xl font-bold text-white">Food Security</h4>
        </div>
       </div>
       <div class="p-6">
        <p class="text-gray-700 mb-4"><strong>Food Security</strong> - Ensuring all people have access to sufficient, safe, and nutritious food.</p>
        <ul class="text-sm text-gray-600 space-y-2">
         <li>‚Ä¢ 828 million people face hunger worldwide</li>
         <li>‚Ä¢ Climate change affects agriculture</li>
         <li>‚Ä¢ Conflicts and wars cause food shortages</li>
         <li>‚Ä¢ Need for sustainable farming development</li>
        </ul>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
        // Configuration
        const defaultConfig = {
            unit_title: "Unit 6: Social Issues",
            home_url: "https://nckhthptnk.github.io/tienganh11/"
        };

        // Data SDK Handler
        const dataHandler = {
            onDataChanged(data) {
                updateProgressFromData(data);
            }
        };

        // Vocabulary data
        const vocabularyData = [
            {
                word: "war",
                pronunciation: "/w…îÀê/",
                type: "(noun)",
                meaning: "chi·∫øn tranh",
                example: "The <span class='highlight'>war</span> caused massive displacement of civilians."
            },
            {
                word: "homeless",
                pronunciation: "/Ààh…ô äml…ôs/",
                type: "(adjective)",
                meaning: "v√¥ gia c∆∞",
                example: "Many <span class='highlight'>homeless</span> people need shelter and food."
            },
            {
                word: "disease",
                pronunciation: "/d…™ÀàziÀêz/",
                type: "(noun)",
                meaning: "b·ªánh t·∫≠t",
                example: "Preventing <span class='highlight'>disease</span> is better than treating it."
            },
            {
                word: "hunger",
                pronunciation: "/Ààh å≈ã…°…ô/",
                type: "(noun)",
                meaning: "ƒë√≥i kh√°t",
                example: "World <span class='highlight'>hunger</span> affects millions of children."
            },
            {
                word: "unemployment",
                pronunciation: "/Àå ån…™mÀàpl…î…™m…ônt/",
                type: "(noun)",
                meaning: "th·∫•t nghi·ªáp",
                example: "<span class='highlight'>Unemployment</span> rates have risen during the crisis."
            },
            {
                word: "racism",
                pronunciation: "/Ààre…™s…™z…ôm/",
                type: "(noun)",
                meaning: "ph√¢n bi·ªát ch·ªßng t·ªôc",
                example: "We must fight against <span class='highlight'>racism</span> in all its forms."
            },
            {
                word: "solve",
                pronunciation: "/s…ílv/",
                type: "(verb)",
                meaning: "gi·∫£i quy·∫øt",
                example: "We need to <span class='highlight'>solve</span> these social problems together."
            },
            {
                word: "affordable",
                pronunciation: "/…ôÀàf…îÀêd…ôbl/",
                type: "(adjective)",
                meaning: "c√≥ th·ªÉ chi tr·∫£ ƒë∆∞·ª£c",
                example: "Everyone deserves access to <span class='highlight'>affordable</span> healthcare."
            },
            {
                word: "respect",
                pronunciation: "/r…™Ààspekt/",
                type: "(noun/verb)",
                meaning: "t√¥n tr·ªçng",
                example: "We should <span class='highlight'>respect</span> people from all backgrounds."
            },
            {
                word: "collect",
                pronunciation: "/k…ôÀàlekt/",
                type: "(verb)",
                meaning: "thu th·∫≠p",
                example: "The charity will <span class='highlight'>collect</span> donations for the victims."
            },
            {
                word: "nationality",
                pronunciation: "/Àån√¶ É…ôÀàn√¶l…ôti/",
                type: "(noun)",
                meaning: "qu·ªëc t·ªãch",
                example: "Discrimination based on <span class='highlight'>nationality</span> is unacceptable."
            },
            {
                word: "non-profit",
                pronunciation: "/n…ín Ààpr…íf…™t/",
                type: "(adjective)",
                meaning: "phi l·ª£i nhu·∫≠n",
                example: "The <span class='highlight'>non-profit</span> organization helps poor families."
            },
            {
                word: "organization",
                pronunciation: "/Àå…îÀê…°…ôna…™Ààze…™ Én/",
                type: "(noun)",
                meaning: "t·ªï ch·ª©c",
                example: "The <span class='highlight'>organization</span> provides aid to refugees."
            },
            {
                word: "focus on",
                pronunciation: "/Ààf…ô äk…ôs …ín/",
                type: "(phrasal verb)",
                meaning: "t·∫≠p trung v√†o",
                example: "We should <span class='highlight'>focus on</span> helping the most vulnerable."
            },
            {
                word: "deal with",
                pronunciation: "/diÀêl w…™√∞/",
                type: "(phrasal verb)",
                meaning: "gi·∫£i quy·∫øt, ƒë·ªëi ph√≥ v·ªõi",
                example: "How can we <span class='highlight'>deal with</span> poverty effectively?"
            },
            {
                word: "charity",
                pronunciation: "/Ààt É√¶r…ôti/",
                type: "(noun)",
                meaning: "t·ª´ thi·ªán",
                example: "The <span class='highlight'>charity</span> raised money for disaster victims."
            },
            {
                word: "effort",
                pronunciation: "/Ààef…ôt/",
                type: "(noun)",
                meaning: "n·ªó l·ª±c",
                example: "It takes collective <span class='highlight'>effort</span> to solve social issues."
            },
            {
                word: "recognise",
                pronunciation: "/Ààrek…ô…°na…™z/",
                type: "(verb)",
                meaning: "nh·∫≠n ra, c√¥ng nh·∫≠n",
                example: "We must <span class='highlight'>recognise</span> the signs of mental illness."
            },
            {
                word: "symptom",
                pronunciation: "/Ààs…™mpt…ôm/",
                type: "(noun)",
                meaning: "tri·ªáu ch·ª©ng",
                example: "Fever is a common <span class='highlight'>symptom</span> of many diseases."
            },
            {
                word: "tuberculosis",
                pronunciation: "/tjuÀêÀåb…úÀêkjuÀàl…ô äs…™s/",
                type: "(noun)",
                meaning: "b·ªánh lao",
                example: "<span class='highlight'>Tuberculosis</span> is still a major health problem worldwide."
            },
            {
                word: "malaria",
                pronunciation: "/m…ôÀàle…ôri…ô/",
                type: "(noun)",
                meaning: "b·ªánh s·ªët r√©t",
                example: "<span class='highlight'>Malaria</span> affects millions in tropical regions."
            },
            {
                word: "scale",
                pronunciation: "/ske…™l/",
                type: "(noun)",
                meaning: "quy m√¥",
                example: "The problem exists on a global <span class='highlight'>scale</span>."
            },
            {
                word: "life-threatening",
                pronunciation: "/la…™f ÀàŒ∏retn…™≈ã/",
                type: "(adjective)",
                meaning: "ƒëe d·ªça t√≠nh m·∫°ng",
                example: "Some diseases are <span class='highlight'>life-threatening</span> without treatment."
            },
            {
                word: "invest",
                pronunciation: "/…™nÀàvest/",
                type: "(verb)",
                meaning: "ƒë·∫ßu t∆∞",
                example: "Governments should <span class='highlight'>invest</span> more in education."
            },
            {
                word: "crisis",
                pronunciation: "/Ààkra…™s…™s/",
                type: "(noun)",
                meaning: "kh·ªßng ho·∫£ng",
                example: "The economic <span class='highlight'>crisis</span> affected many families."
            },
            {
                word: "conduct",
                pronunciation: "/k…ônÀàd åkt/",
                type: "(verb)",
                meaning: "ti·∫øn h√†nh",
                example: "Researchers will <span class='highlight'>conduct</span> a study on poverty."
            },
            {
                word: "conflict",
                pronunciation: "/Ààk…ínfl…™kt/",
                type: "(noun)",
                meaning: "xung ƒë·ªôt",
                example: "Armed <span class='highlight'>conflict</span> creates humanitarian disasters."
            },
            {
                word: "accent",
                pronunciation: "/Àà√¶ksent/",
                type: "(noun)",
                meaning: "gi·ªçng n√≥i",
                example: "Don't judge people by their <span class='highlight'>accent</span> or appearance."
            },
            {
                word: "steal",
                pronunciation: "/stiÀêl/",
                type: "(verb)",
                meaning: "ƒÉn c·∫Øp",
                example: "Poverty sometimes forces people to <span class='highlight'>steal</span> food."
            },
            {
                word: "candidate",
                pronunciation: "/Ààk√¶nd…™d…ôt/",
                type: "(noun)",
                meaning: "·ª©ng c·ª≠ vi√™n",
                example: "The <span class='highlight'>candidate</span> promised to reduce unemployment."
            },
            {
                word: "struggle",
                pronunciation: "/Ààstr å…°l/",
                type: "(verb/noun)",
                meaning: "ƒë·∫•u tranh, cu·ªôc ƒë·∫•u tranh",
                example: "Many families <span class='highlight'>struggle</span> to pay for basic needs."
            },
            {
                word: "movement",
                pronunciation: "/ÀàmuÀêvm…ônt/",
                type: "(noun)",
                meaning: "phong tr√†o",
                example: "The civil rights <span class='highlight'>movement</span> fought for equality."
            },
            {
                word: "poverty",
                pronunciation: "/Ààp…ív…ôti/",
                type: "(noun)",
                meaning: "ngh√®o ƒë√≥i",
                example: "Extreme <span class='highlight'>poverty</span> affects billions worldwide."
            },
            {
                word: "depression",
                pronunciation: "/d…™Ààpre Én/",
                type: "(noun)",
                meaning: "tr·∫ßm c·∫£m",
                example: "Mental health issues like <span class='highlight'>depression</span> need attention."
            },
            {
                word: "obesity",
                pronunciation: "/…ô äÀàbiÀês…ôti/",
                type: "(noun)",
                meaning: "b√©o ph√¨",
                example: "Childhood <span class='highlight'>obesity</span> is becoming more common."
            },
            {
                word: "bullying",
                pronunciation: "/Ààb äli…™≈ã/",
                type: "(noun)",
                meaning: "b·∫Øt n·∫°t",
                example: "School <span class='highlight'>bullying</span> can cause serious psychological harm."
            },
            {
                word: "crime",
                pronunciation: "/kra…™m/",
                type: "(noun)",
                meaning: "t·ªôi ph·∫°m",
                example: "High unemployment often leads to increased <span class='highlight'>crime</span>."
            },
            {
                word: "healthcare",
                pronunciation: "/ÀàhelŒ∏ke…ô/",
                type: "(noun)",
                meaning: "chƒÉm s√≥c s·ª©c kh·ªèe",
                example: "Access to quality <span class='highlight'>healthcare</span> is a basic right."
            },
            {
                word: "pollution",
                pronunciation: "/p…ôÀàluÀê Én/",
                type: "(noun)",
                meaning: "√¥ nhi·ªÖm",
                example: "Air <span class='highlight'>pollution</span> causes respiratory diseases."
            },
            {
                word: "gender inequality",
                pronunciation: "/Ààd íend…ô Àå…™n…™Ààkw…íl…ôti/",
                type: "(noun phrase)",
                meaning: "b·∫•t b√¨nh ƒë·∫≥ng gi·ªõi",
                example: "<span class='highlight'>Gender inequality</span> limits women's opportunities."
            },
            {
                word: "rely on",
                pronunciation: "/r…™Ààla…™ …ín/",
                type: "(phrasal verb)",
                meaning: "d·ª±a v√†o",
                example: "Many people <span class='highlight'>rely on</span> government assistance."
            },
            {
                word: "shelter",
                pronunciation: "/Àà Éelt…ô/",
                type: "(noun)",
                meaning: "n∆°i tr√∫ ·∫©n",
                example: "Homeless people need food and <span class='highlight'>shelter</span>."
            },
            {
                word: "deliver",
                pronunciation: "/d…™Ààl…™v…ô/",
                type: "(verb)",
                meaning: "giao, cung c·∫•p",
                example: "Volunteers <span class='highlight'>deliver</span> food to elderly people."
            },
            {
                word: "postpone",
                pronunciation: "/p…ôÀàsp…ô än/",
                type: "(verb)",
                meaning: "ho√£n l·∫°i",
                example: "They had to <span class='highlight'>postpone</span> the charity event."
            },
            {
                word: "volunteer",
                pronunciation: "/Àåv…íl…ônÀàt…™…ô/",
                type: "(noun/verb)",
                meaning: "t√¨nh nguy·ªán vi√™n / l√†m t√¨nh nguy·ªán",
                example: "Many people <span class='highlight'>volunteer</span> at homeless shelters."
            },
            {
                word: "donate",
                pronunciation: "/d…ô äÀàne…™t/",
                type: "(verb)",
                meaning: "quy√™n g√≥p",
                example: "Please <span class='highlight'>donate</span> money to help disaster victims."
            },
            {
                word: "fundraising",
                pronunciation: "/Ààf åndre…™z…™≈ã/",
                type: "(noun)",
                meaning: "g√¢y qu·ªπ",
                example: "The school organized a <span class='highlight'>fundraising</span> event."
            },
            {
                word: "recommend",
                pronunciation: "/Àårek…ôÀàmend/",
                type: "(verb)",
                meaning: "khuy·∫øn ngh·ªã",
                example: "Doctors <span class='highlight'>recommend</span> regular health check-ups."
            },
            {
                word: "difficulty",
                pronunciation: "/Ààd…™f…™k…ôlti/",
                type: "(noun)",
                meaning: "kh√≥ khƒÉn",
                example: "Many families face financial <span class='highlight'>difficulty</span>."
            },
            {
                word: "blanket",
                pronunciation: "/Ààbl√¶≈ãk…™t/",
                type: "(noun)",
                meaning: "chƒÉn",
                example: "Refugees need warm <span class='highlight'>blankets</span> during winter."
            },
            {
                word: "improve",
                pronunciation: "/…™mÀàpruÀêv/",
                type: "(verb)",
                meaning: "c·∫£i thi·ªán",
                example: "Education can <span class='highlight'>improve</span> people's lives."
            },
            {
                word: "economy",
                pronunciation: "/…™Ààk…ín…ômi/",
                type: "(noun)",
                meaning: "n·ªÅn kinh t·∫ø",
                example: "A strong <span class='highlight'>economy</span> creates more jobs."
            },
            {
                word: "campaign",
                pronunciation: "/k√¶mÀàpe…™n/",
                type: "(noun)",
                meaning: "chi·∫øn d·ªãch",
                example: "The awareness <span class='highlight'>campaign</span> was very successful."
            },
            {
                word: "protest",
                pronunciation: "/Ààpr…ô ätest/",
                type: "(noun/verb)",
                meaning: "bi·ªÉu t√¨nh",
                example: "People <span class='highlight'>protest</span> against social injustice."
            },
            {
                word: "fill up",
                pronunciation: "/f…™l  åp/",
                type: "(phrasal verb)",
                meaning: "l√†m ƒë·∫ßy",
                example: "The shelter quickly <span class='highlight'>filled up</span> with homeless people."
            },
            {
                word: "cash",
                pronunciation: "/k√¶ É/",
                type: "(noun)",
                meaning: "ti·ªÅn m·∫∑t",
                example: "The charity needs <span class='highlight'>cash</span> donations urgently."
            },
            {
                word: "ensure",
                pronunciation: "/…™nÀà É ä…ô/",
                type: "(verb)",
                meaning: "ƒë·∫£m b·∫£o",
                example: "We must <span class='highlight'>ensure</span> equal rights for everyone."
            },
            {
                word: "burglary",
                pronunciation: "/Ààb…úÀê…°l…ôri/",
                type: "(noun)",
                meaning: "tr·ªôm c·∫Øp",
                example: "<span class='highlight'>Burglary</span> rates increase in poor neighborhoods."
            },
            {
                word: "stamp",
                pronunciation: "/st√¶mp/",
                type: "(noun)",
                meaning: "tem",
                example: "Food <span class='highlight'>stamps</span> help low-income families."
            },
            {
                word: "citizen",
                pronunciation: "/Ààs…™t…™zn/",
                type: "(noun)",
                meaning: "c√¥ng d√¢n",
                example: "Every <span class='highlight'>citizen</span> has rights and responsibilities."
            },
            {
                word: "chance",
                pronunciation: "/t É…ëÀêns/",
                type: "(noun)",
                meaning: "c∆° h·ªôi",
                example: "Everyone deserves a <span class='highlight'>chance</span> for a better life."
            },
            {
                word: "assistant",
                pronunciation: "/…ôÀàs…™st…ônt/",
                type: "(noun)",
                meaning: "tr·ª£ l√Ω",
                example: "The social worker's <span class='highlight'>assistant</span> helped families."
            },
            {
                word: "training",
                pronunciation: "/Ààtre…™n…™≈ã/",
                type: "(noun)",
                meaning: "ƒë√†o t·∫°o",
                example: "Job <span class='highlight'>training</span> programs help unemployed people."
            },
            {
                word: "consequently",
                pronunciation: "/Ààk…íns…™kw…ôntli/",
                type: "(adverb)",
                meaning: "do ƒë√≥",
                example: "Poverty increased; <span class='highlight'>consequently</span>, crime rates rose."
            },
            {
                word: "physical",
                pronunciation: "/Ààf…™z…™kl/",
                type: "(adjective)",
                meaning: "th·ªÉ ch·∫•t",
                example: "Both mental and <span class='highlight'>physical</span> health are important."
            },
            {
                word: "harmful",
                pronunciation: "/Ààh…ëÀêmfl/",
                type: "(adjective)",
                meaning: "c√≥ h·∫°i",
                example: "Pollution is <span class='highlight'>harmful</span> to human health."
            },
            {
                word: "keen on",
                pronunciation: "/kiÀên …ín/",
                type: "(adjective phrase)",
                meaning: "quan t√¢m ƒë·∫øn",
                example: "Young people are <span class='highlight'>keen on</span> social justice issues."
            }
        ];

        // Reading quiz questions
        const readingQuestions = [
            {
                question: "The phrase \"Addressing these challenges\" in paragraph 1 is CLOSEST in meaning to ________________.",
                options: ["Ignoring social problems", "Dealing with social issues", "Creating new difficulties", "Avoiding responsibilities"],
                correct: 1
            },
            {
                question: "What do \"non-profit organizations\" in paragraph 1 primarily focus on?",
                options: ["Making money from social problems", "Providing help without seeking profit", "Competing with government agencies", "Selling services to communities"],
                correct: 1
            },
            {
                question: "The phrase \"Early intervention and community support\" in paragraph 2 refers to ________________.",
                options: ["Late treatment of mental illness", "Preventing problems before they worsen", "Expensive medical procedures", "Individual therapy sessions only"],
                correct: 1
            },
            {
                question: "In which paragraph does the writer discuss environmental impacts on vulnerable populations?",
                options: ["Paragraph 1", "Paragraph 2", "Paragraph 3", "Paragraph 4"],
                correct: 2
            },
            {
                question: "Where in the passage does the following sentence best fit? \"This creates additional barriers to accessing essential services.\"",
                options: ["[I]", "[II]", "[III]", "[IV]"],
                correct: 1
            },
            {
                question: "Which of the following is TRUE according to the passage?",
                options: ["Mental health issues only affect elderly people.", "Environmental problems equally impact all social classes.", "Social stigma prevents people from seeking mental health help.", "Charities work independently without community involvement."],
                correct: 2
            },
            {
                question: "Which of the following best paraphrases the underlined phrase \"adapt to environmental changes\" in paragraph 3?",
                options: ["Ignore climate problems completely", "Adjust to new environmental conditions", "Move to different countries permanently", "Stop all industrial activities immediately"],
                correct: 1
            },
            {
                question: "Which can be inferred from the passage?",
                options: ["Social problems can be solved quickly with enough money.", "Environmental policies should prioritize economic growth over equality.", "Successful social programs require sustained effort and resources.", "Mental health issues are less important than physical problems."],
                correct: 2
            }
        ];

        // Grammar quiz questions
        const grammarQuestions = [
            {
                question: "Choose the correct gerund form: I enjoy _____ books.",
                options: ["read", "reading", "to read", "reads"],
                correct: 1
            },
            {
                question: "Complete the question tag: You are a student, _____?",
                options: ["are you", "aren't you", "do you", "don't you"],
                correct: 1
            },
            {
                question: "_____ is my favorite hobby.",
                options: ["Swim", "Swimming", "To swim", "Swims"],
                correct: 1
            },
            {
                question: "She doesn't like coffee, _____?",
                options: ["does she", "doesn't she", "is she", "isn't she"],
                correct: 0
            },
            {
                question: "I'm interested in _____ English.",
                options: ["learn", "learning", "to learn", "learned"],
                correct: 1
            },
            {
                question: "They can swim, _____?",
                options: ["can they", "can't they", "do they", "don't they"],
                correct: 1
            },
            {
                question: "_____ others makes me happy.",
                options: ["Help", "Helping", "To help", "Helped"],
                correct: 1
            },
            {
                question: "You won't come, _____?",
                options: ["will you", "won't you", "do you", "don't you"],
                correct: 0
            },
            {
                question: "She avoided _____ about the problem.",
                options: ["talk", "talking", "to talk", "talked"],
                correct: 1
            },
            {
                question: "He is tall, _____?",
                options: ["is he", "isn't he", "does he", "doesn't he"],
                correct: 1
            },
            {
                question: "I suggested _____ a break.",
                options: ["take", "taking", "to take", "took"],
                correct: 1
            },
            {
                question: "We aren't late, _____?",
                options: ["are we", "aren't we", "do we", "don't we"],
                correct: 0
            },
            {
                question: "_____ is not allowed here.",
                options: ["Smoke", "Smoking", "To smoke", "Smoked"],
                correct: 1
            },
            {
                question: "You have finished, _____?",
                options: ["have you", "haven't you", "do you", "don't you"],
                correct: 1
            },
            {
                question: "They finished _____ the project.",
                options: ["complete", "completing", "to complete", "completed"],
                correct: 1
            },
            {
                question: "She will help us, _____?",
                options: ["will she", "won't she", "does she", "doesn't she"],
                correct: 1
            },
            {
                question: "I don't mind _____ early.",
                options: ["wake up", "waking up", "to wake up", "woke up"],
                correct: 1
            },
            {
                question: "You didn't call me, _____?",
                options: ["did you", "didn't you", "do you", "don't you"],
                correct: 0
            },
            {
                question: "_____ languages is useful.",
                options: ["Learn", "Learning", "To learn", "Learned"],
                correct: 1
            },
            {
                question: "They should study harder, _____?",
                options: ["should they", "shouldn't they", "do they", "don't they"],
                correct: 1
            },
            {
                question: "He kept _____ the same mistake.",
                options: ["make", "making", "to make", "made"],
                correct: 1
            },
            {
                question: "You are coming, _____?",
                options: ["are you", "aren't you", "do you", "don't you"],
                correct: 1
            },
            {
                question: "She enjoys _____ music.",
                options: ["listen to", "listening to", "to listen to", "listened to"],
                correct: 1
            },
            {
                question: "He wasn't here yesterday, _____?",
                options: ["was he", "wasn't he", "did he", "didn't he"],
                correct: 0
            },
            {
                question: "_____ exercise is important for health.",
                options: ["Do", "Doing", "To do", "Did"],
                correct: 1
            },
            {
                question: "You could help me, _____?",
                options: ["could you", "couldn't you", "can you", "can't you"],
                correct: 1
            },
            {
                question: "I appreciate your _____ me.",
                options: ["help", "helping", "to help", "helped"],
                correct: 1
            },
            {
                question: "She has been here before, _____?",
                options: ["has she", "hasn't she", "does she", "doesn't she"],
                correct: 1
            },
            {
                question: "They stopped _____ when I arrived.",
                options: ["talk", "talking", "to talk", "talked"],
                correct: 1
            },
            {
                question: "You wouldn't lie to me, _____?",
                options: ["would you", "wouldn't you", "do you", "don't you"],
                correct: 0
            }
        ];

        // State variables
        let currentCardIndex = 0;
        let currentSection = 'vocabulary';
        let currentVocabMode = 'flashcard';
        let isCardFlipped = false;
        let currentReadingQuestion = 0;
        let readingScore = 0;
        let currentGrammarQuestion = 0;
        let grammarScore = 0;
        let readingCompleted = false;
        let grammarCompleted = false;
        let vocabTestQuestions = [];
        let vocabTestScore = 0;
        let vocabTestAnswered = 0;
        let currentVocabTestQuestion = 0;
        let vocabLearningStarted = false;
        let learnedCards = new Set();

        // Initialize app
        async function initApp() {
            if (window.dataSdk) {
                const result = await window.dataSdk.init(dataHandler);
                if (!result.isOk) {
                    console.error("Failed to initialize data SDK");
                }
            }

            if (window.elementSdk) {
                await window.elementSdk.init({
                    defaultConfig,
                    onConfigChange: async (config) => {
                        document.getElementById('unit-title').textContent = config.unit_title || defaultConfig.unit_title;
                    },
                    mapToCapabilities: (config) => ({
                        recolorables: [],
                        borderables: [],
                        fontEditable: undefined,
                        fontSizeable: undefined
                    }),
                    mapToEditPanelValues: (config) => new Map([
                        ["unit_title", config.unit_title || defaultConfig.unit_title],
                        ["home_url", config.home_url || defaultConfig.home_url]
                    ])
                });
            }

            loadVocabularyCard();
            generateReadingQuiz();
            updateProgress();
            
            // Initialize vocabulary mode
            showVocabMode('flashcard');
            
            // Ph√°t √¢m t·ª´ ƒë·∫ßu ti√™n khi t·∫£i trang
            setTimeout(() => {
                speakWord(vocabularyData[0].word);
            }, 1000);
            
            // Add keyboard event listeners
            document.addEventListener('keydown', handleKeyPress);
        }

        // Handle keyboard events
        function handleKeyPress(event) {
            if (currentSection === 'vocabulary' && currentVocabMode === 'flashcard') {
                switch(event.code) {
                    case 'Space':
                        event.preventDefault();
                        flipCard();
                        break;
                    case 'ArrowLeft':
                        event.preventDefault();
                        previousCard();
                        break;
                    case 'ArrowRight':
                        event.preventDefault();
                        nextCard();
                        break;
                }
            }
        }

        // Vocabulary functions
        function showVocabMode(mode) {
            currentVocabMode = mode;
            
            // Update button states
            document.getElementById('flashcard-btn').classList.toggle('active', mode === 'flashcard');
            document.getElementById('test-btn').classList.toggle('active', mode === 'test');
            
            // Show/hide modes
            document.getElementById('flashcard-mode').classList.toggle('hidden', mode !== 'flashcard');
            document.getElementById('test-mode').classList.toggle('hidden', mode !== 'test');
            
            if (mode === 'test' && vocabTestQuestions.length === 0) {
                generateVocabTest();
            }
        }

        function loadVocabularyCard() {
            const card = vocabularyData[currentCardIndex];
            document.getElementById('word-front').textContent = card.word;
            document.getElementById('pronunciation').textContent = card.pronunciation;
            document.getElementById('word-type').textContent = card.type;
            document.getElementById('word-meaning').textContent = card.meaning;
            document.getElementById('word-example').innerHTML = card.example;
            document.getElementById('card-counter').textContent = `${currentCardIndex + 1} / ${vocabularyData.length}`;
            
            // Reset flip state
            isCardFlipped = false;
            document.getElementById('flashcard').classList.remove('flipped');
        }

        function flipCard() {
            const flashcard = document.getElementById('flashcard');
            flashcard.classList.toggle('flipped');
            isCardFlipped = !isCardFlipped;
            
            // ƒê√°nh d·∫•u b·∫Øt ƒë·∫ßu h·ªçc v√† th·∫ª hi·ªán t·∫°i ƒë√£ ƒë∆∞·ª£c xem
            if (!vocabLearningStarted) {
                vocabLearningStarted = true;
            }
            if (isCardFlipped) {
                learnedCards.add(currentCardIndex);
                updateProgress();
            }
            
            playSound('flip');
        }

        function nextCard() {
            if (currentCardIndex < vocabularyData.length - 1) {
                // ƒê√°nh d·∫•u th·∫ª hi·ªán t·∫°i ƒë√£ ƒë∆∞·ª£c h·ªçc
                if (!vocabLearningStarted) {
                    vocabLearningStarted = true;
                }
                learnedCards.add(currentCardIndex);
                
                currentCardIndex++;
                loadVocabularyCard();
                saveProgress('vocabulary', `card_${currentCardIndex}`, true);
                updateProgress();
                
                // Ch·ªâ ph√°t √¢m t·ª´ m·ªõi
                setTimeout(() => {
                    speakWord(vocabularyData[currentCardIndex].word);
                }, 300);
            }
        }

        function previousCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                loadVocabularyCard();
                // Ch·ªâ ph√°t √¢m t·ª´ m·ªõi
                setTimeout(() => {
                    speakWord(vocabularyData[currentCardIndex].word);
                }, 300);
            }
        }

        // Vocabulary test functions
        function generateVocabTest() {
            vocabTestQuestions = [];
            vocabTestScore = 0;
            vocabTestAnswered = 0;
            currentVocabTestQuestion = 0;
            
            // Create questions for each vocabulary word
            vocabularyData.forEach((word, index) => {
                // Question 1: Word to meaning
                const wrongMeanings = vocabularyData
                    .filter((_, i) => i !== index)
                    .map(w => w.meaning)
                    .sort(() => Math.random() - 0.5)
                    .slice(0, 3);
                
                const options1 = [word.meaning, ...wrongMeanings].sort(() => Math.random() - 0.5);
                const correctIndex1 = options1.indexOf(word.meaning);
                
                vocabTestQuestions.push({
                    question: `"${word.word}" c√≥ nghƒ©a l√† g√¨?`,
                    options: options1,
                    correct: correctIndex1,
                    type: 'word-to-meaning',
                    word: word.word,
                    correctAnswer: word.meaning,
                    explanation: `"${word.word}" ${word.pronunciation} ${word.type} c√≥ nghƒ©a l√† "${word.meaning}". V√≠ d·ª•: ${word.example.replace(/<[^>]*>/g, '')}`
                });
                
                // Question 2: Meaning to word (for some words to reach 67 questions)
                if (index < 5) {
                    const wrongWords = vocabularyData
                        .filter((_, i) => i !== index)
                        .map(w => w.word)
                        .sort(() => Math.random() - 0.5)
                        .slice(0, 3);
                    
                    const options2 = [word.word, ...wrongWords].sort(() => Math.random() - 0.5);
                    const correctIndex2 = options2.indexOf(word.word);
                    
                    vocabTestQuestions.push({
                        question: `T·ª´ n√†o c√≥ nghƒ©a l√† "${word.meaning}"?`,
                        options: options2,
                        correct: correctIndex2,
                        type: 'meaning-to-word',
                        word: word.word,
                        correctAnswer: word.word,
                        explanation: `T·ª´ "${word.word}" ${word.pronunciation} ${word.type} c√≥ nghƒ©a l√† "${word.meaning}". V√≠ d·ª•: ${word.example.replace(/<[^>]*>/g, '')}`
                    });
                }
            });
            
            // Shuffle questions
            vocabTestQuestions = vocabTestQuestions.sort(() => Math.random() - 0.5).slice(0, 67);
            
            renderVocabTest();
        }

        function renderVocabTest() {
            const container = document.getElementById('vocab-test-container');
            container.innerHTML = `
                <div class="vocab-test-question-container bg-white rounded-lg shadow-lg border p-6 mb-6">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center font-bold">
                            <span id="vocab-test-question-number">1</span>
                        </div>
                        <div class="flex-1">
                            <p id="vocab-test-question-text" class="font-semibold text-gray-800 mb-4"></p>
                            <div id="vocab-test-options" class="space-y-2"></div>
                            <div id="vocab-test-explanation" class="mt-4 p-4 bg-blue-50 rounded-lg hidden">
                                <p class="text-sm text-blue-800"></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-center items-center gap-4">
                    <button onclick="previousVocabTestQuestion()" id="vocab-test-prev-btn" class="control-button bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        ‚Üê C√¢u tr∆∞·ªõc
                    </button>
                    <button onclick="nextVocabTestQuestion()" id="vocab-test-next-btn" class="control-button bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold hidden">
                        C√¢u ti·∫øp ‚Üí
                    </button>
                    <button onclick="resetVocabTest()" id="vocab-test-reset-btn" class="control-button bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-semibold hidden">
                        L√†m l·∫°i
                    </button>
                </div>
            `;
            
            loadVocabTestQuestion();
        }

        function loadVocabTestQuestion() {
            const question = vocabTestQuestions[currentVocabTestQuestion];
            
            document.getElementById('vocab-test-question-number').textContent = currentVocabTestQuestion + 1;
            document.getElementById('vocab-test-question-text').textContent = question.question;
            document.getElementById('test-current').textContent = currentVocabTestQuestion + 1;
            document.getElementById('test-total').textContent = vocabTestQuestions.length;
            
            const optionsContainer = document.getElementById('vocab-test-options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'vocab-test-option w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-all duration-200';
                button.innerHTML = `<span class="font-medium text-blue-600 mr-3">${String.fromCharCode(65 + index)}.</span>${option}`;
                button.onclick = () => selectVocabTestAnswer(index);
                button.id = `vocab-test-current-option-${index}`;
                optionsContainer.appendChild(button);
            });
            
            // Update navigation buttons
            document.getElementById('vocab-test-prev-btn').disabled = currentVocabTestQuestion === 0;
            document.getElementById('vocab-test-explanation').classList.add('hidden');
            
            // Update progress bar
            const progressPercent = ((currentVocabTestQuestion + 1) / vocabTestQuestions.length) * 100;
            document.getElementById('test-progress-bar').style.width = progressPercent + '%';
        }

        function selectVocabTestAnswer(optionIndex) {
            const question = vocabTestQuestions[currentVocabTestQuestion];
            const isCorrect = optionIndex === question.correct;
            
            // Disable all options
            for (let i = 0; i < question.options.length; i++) {
                const option = document.getElementById(`vocab-test-current-option-${i}`);
                option.disabled = true;
                option.classList.add('disabled');
                option.style.cursor = 'not-allowed';
                
                if (i === question.correct) {
                    option.classList.add('correct');
                } else if (i === optionIndex && !isCorrect) {
                    option.classList.add('incorrect');
                }
            }
            
            // Show explanation
            const explanationDiv = document.getElementById('vocab-test-explanation');
            const explanationText = explanationDiv.querySelector('p');
            
            if (isCorrect) {
                vocabTestScore++;
                explanationText.textContent = '‚úÖ Ch√≠nh x√°c! ' + question.explanation;
                explanationDiv.className = 'mt-4 p-4 bg-green-50 rounded-lg';
                explanationText.className = 'text-sm text-green-800';
                playSound('correct');
            } else {
                explanationText.textContent = '‚ùå Sai r·ªìi! ƒê√°p √°n ƒë√∫ng l√†: ' + question.correctAnswer + '. ' + question.explanation;
                explanationDiv.className = 'mt-4 p-4 bg-red-50 rounded-lg';
                explanationText.className = 'text-sm text-red-800';
                playSound('incorrect');
            }
            
            explanationDiv.classList.remove('hidden');
            
            // Update score display
            document.getElementById('test-score').textContent = vocabTestScore;
            
            // Show next button or reset button
            if (currentVocabTestQuestion < vocabTestQuestions.length - 1) {
                document.getElementById('vocab-test-next-btn').classList.remove('hidden');
            } else {
                document.getElementById('vocab-test-reset-btn').classList.remove('hidden');
                saveProgress('vocabulary_test', 'completed', true, vocabTestScore);
            }
        }

        function nextVocabTestQuestion() {
            if (currentVocabTestQuestion < vocabTestQuestions.length - 1) {
                currentVocabTestQuestion++;
                loadVocabTestQuestion();
                document.getElementById('vocab-test-next-btn').classList.add('hidden');
            }
        }

        function previousVocabTestQuestion() {
            if (currentVocabTestQuestion > 0) {
                currentVocabTestQuestion--;
                loadVocabTestQuestion();
                document.getElementById('vocab-test-next-btn').classList.add('hidden');
                document.getElementById('vocab-test-reset-btn').classList.add('hidden');
            }
        }

        function updateVocabTestProgress() {
            // This function is now handled in loadVocabTestQuestion
        }

        function resetVocabTest() {
            currentVocabTestQuestion = 0;
            vocabTestScore = 0;
            vocabTestAnswered = 0;
            generateVocabTest();
        }

        // Section navigation
        function showSection(section) {
            // Hide all sections
            document.getElementById('vocabulary-section').classList.add('hidden');
            document.getElementById('reading-section').classList.add('hidden');
            document.getElementById('grammar-section').classList.add('hidden');
            document.getElementById('social-issues-section').classList.add('hidden');
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab-button').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected section and activate tab
            document.getElementById(`${section}-section`).classList.remove('hidden');
            document.getElementById(`${section}-tab`).classList.add('active');
            
            currentSection = section;
            
            if (section === 'reading') {
                if (!readingCompleted) {
                    generateReadingQuiz();
                }
            }
        }



        // Reading functions
        function generateReadingQuiz() {
            const quizContainer = document.getElementById('reading-quiz');
            quizContainer.innerHTML = '<h4 class="text-xl font-bold text-gray-800 mb-4">C√¢u h·ªèi tr·∫Øc nghi·ªám</h4>';
            
            readingQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'mb-6 p-4 bg-white rounded-lg shadow-sm border';
                questionDiv.innerHTML = `
                    <p class="font-semibold text-gray-800 mb-3">${index + 1}. ${q.question}</p>
                    <div class="space-y-2">
                        ${q.options.map((option, optIndex) => `
                            <button onclick="selectReadingAnswer(${index}, ${optIndex})" 
                                    class="quiz-option w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-all duration-200"
                                    id="reading-option-${index}-${optIndex}">
                                ${String.fromCharCode(65 + optIndex)}. ${option}
                            </button>
                        `).join('')}
                    </div>
                `;
                quizContainer.appendChild(questionDiv);
            });
        }

        function selectReadingAnswer(questionIndex, optionIndex) {
            const question = readingQuestions[questionIndex];
            const isCorrect = optionIndex === question.correct;
            
            // Disable all options for this question
            for (let i = 0; i < question.options.length; i++) {
                const option = document.getElementById(`reading-option-${questionIndex}-${i}`);
                option.disabled = true;
                option.style.cursor = 'not-allowed';
                
                if (i === question.correct) {
                    option.classList.add('correct');
                } else if (i === optionIndex && !isCorrect) {
                    option.classList.add('incorrect');
                }
            }
            
            if (isCorrect) {
                readingScore++;
                playSound('correct');
            } else {
                playSound('incorrect');
            }
            
            // Check if all questions are answered
            setTimeout(() => {
                checkReadingCompletion();
            }, 1000);
        }

        function checkReadingCompletion() {
            const answeredQuestions = document.querySelectorAll('.quiz-option.correct, .quiz-option.incorrect').length;
            if (answeredQuestions >= readingQuestions.length) {
                readingCompleted = true;
                saveProgress('reading', 'completed', true, readingScore);
                updateProgress();
            }
        }

        // Grammar functions
        function toggleGrammarContent(type) {
            // Close all grammar content sections first
            const allGrammarContents = document.querySelectorAll('.grammar-content');
            allGrammarContents.forEach(content => {
                content.classList.remove('active');
            });
            
            // Open the selected content
            const selectedContent = document.getElementById(`${type}-content`);
            selectedContent.classList.add('active');
        }

        function showGrammarQuiz() {
            // Close all grammar theory sections first
            const allGrammarContents = document.querySelectorAll('.grammar-content');
            allGrammarContents.forEach(content => {
                content.classList.remove('active');
            });
            
            // Toggle the quiz section
            const grammarQuizSection = document.getElementById('grammar-quiz');
            grammarQuizSection.classList.toggle('hidden');
            
            // Generate quiz if it's being shown and hasn't been generated yet
            if (!grammarQuizSection.classList.contains('hidden') && !grammarQuizSection.querySelector('.grammar-question-container')) {
                generateGrammarQuiz();
            }
        }

        function generateGrammarQuiz() {
            const quizContainer = document.getElementById('grammar-quiz-content');
            quizContainer.innerHTML = `
                <div class="text-center mb-6">
                    <div class="bg-gray-200 rounded-full h-3 w-full max-w-md mx-auto mb-4">
                        <div id="grammar-progress-bar" class="bg-purple-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                    <p class="text-sm text-gray-600">
                        C√¢u <span id="grammar-current">1</span> / <span id="grammar-total">${grammarQuestions.length}</span>
                        | ƒêi·ªÉm: <span id="grammar-score">0</span>/${grammarQuestions.length}
                    </p>
                </div>
                
                <div class="grammar-question-container bg-white rounded-lg shadow-lg border p-6 mb-6">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-purple-100 text-purple-600 rounded-full flex items-center justify-center font-bold">
                            <span id="grammar-question-number">1</span>
                        </div>
                        <div class="flex-1">
                            <p id="grammar-question-text" class="font-semibold text-gray-800 mb-4"></p>
                            <div id="grammar-options" class="space-y-2"></div>
                            <div id="grammar-explanation" class="mt-4 p-4 bg-blue-50 rounded-lg hidden">
                                <p class="text-sm text-blue-800"></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-center items-center gap-4">
                    <button onclick="previousGrammarQuestion()" id="grammar-prev-btn" class="control-button bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        ‚Üê C√¢u tr∆∞·ªõc
                    </button>
                    <button onclick="nextGrammarQuestion()" id="grammar-next-btn" class="control-button bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-semibold hidden">
                        C√¢u ti·∫øp ‚Üí
                    </button>
                    <button onclick="resetGrammarQuiz()" id="grammar-reset-btn" class="control-button bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg font-semibold hidden">
                        L√†m l·∫°i
                    </button>
                </div>
            `;
            
            loadGrammarQuestion();
        }

        function loadGrammarQuestion() {
            const question = grammarQuestions[currentGrammarQuestion];
            
            document.getElementById('grammar-question-number').textContent = currentGrammarQuestion + 1;
            document.getElementById('grammar-question-text').textContent = question.question;
            document.getElementById('grammar-current').textContent = currentGrammarQuestion + 1;
            document.getElementById('grammar-total').textContent = grammarQuestions.length;
            
            const optionsContainer = document.getElementById('grammar-options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'grammar-quiz-option w-full text-left p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-all duration-200';
                button.innerHTML = `<span class="font-medium text-purple-600 mr-3">${String.fromCharCode(65 + index)}.</span>${option}`;
                button.onclick = () => selectGrammarAnswer(index);
                button.id = `grammar-current-option-${index}`;
                optionsContainer.appendChild(button);
            });
            
            // Update navigation buttons
            document.getElementById('grammar-prev-btn').disabled = currentGrammarQuestion === 0;
            document.getElementById('grammar-explanation').classList.add('hidden');
        }

        function selectGrammarAnswer(optionIndex) {
            const question = grammarQuestions[currentGrammarQuestion];
            const isCorrect = optionIndex === question.correct;
            
            // Disable all options
            for (let i = 0; i < question.options.length; i++) {
                const option = document.getElementById(`grammar-current-option-${i}`);
                option.disabled = true;
                option.classList.add('disabled');
                option.style.cursor = 'not-allowed';
                
                if (i === question.correct) {
                    option.classList.add('correct');
                } else if (i === optionIndex && !isCorrect) {
                    option.classList.add('incorrect');
                }
            }
            
            // Show explanation
            const explanationDiv = document.getElementById('grammar-explanation');
            const explanationText = explanationDiv.querySelector('p');
            
            if (isCorrect) {
                grammarScore++;
                explanationText.textContent = '‚úÖ Ch√≠nh x√°c! ' + getGrammarExplanation(currentGrammarQuestion);
                explanationDiv.className = 'mt-4 p-4 bg-green-50 rounded-lg';
                explanationText.className = 'text-sm text-green-800';
                playSound('correct');
            } else {
                explanationText.textContent = '‚ùå Sai r·ªìi! ƒê√°p √°n ƒë√∫ng l√†: ' + question.options[question.correct] + '. ' + getGrammarExplanation(currentGrammarQuestion);
                explanationDiv.className = 'mt-4 p-4 bg-red-50 rounded-lg';
                explanationText.className = 'text-sm text-red-800';
                playSound('incorrect');
            }
            
            explanationDiv.classList.remove('hidden');
            
            // Update progress
            updateGrammarProgress();
            
            // Show next button or reset button
            if (currentGrammarQuestion < grammarQuestions.length - 1) {
                document.getElementById('grammar-next-btn').classList.remove('hidden');
            } else {
                document.getElementById('grammar-reset-btn').classList.remove('hidden');
                grammarCompleted = true;
                saveProgress('grammar', 'completed', true, grammarScore);
                updateProgress();
            }
        }

        function getGrammarExplanation(questionIndex) {
            const explanations = [
                "Sau 'enjoy' ta d√πng V-ing (gerund).",
                "C√¢u kh·∫≥ng ƒë·ªãnh + question tag ph·ªß ƒë·ªãnh.",
                "Gerund l√†m ch·ªß ng·ªØ trong c√¢u.",
                "C√¢u ph·ªß ƒë·ªãnh + question tag kh·∫≥ng ƒë·ªãnh.",
                "Sau gi·ªõi t·ª´ 'in' ta d√πng V-ing.",
                "V·ªõi ƒë·ªông t·ª´ khuy·∫øt thi·∫øu 'can', question tag l√† 'can't'.",
                "Gerund l√†m ch·ªß ng·ªØ trong c√¢u.",
                "V·ªõi 'won't' (will not), question tag l√† 'will'.",
                "Sau 'avoid' ta d√πng V-ing.",
                "V·ªõi 'is', question tag l√† 'isn't'.",
                "Sau 'suggest' ta d√πng V-ing.",
                "V·ªõi 'aren't', question tag l√† 'are'.",
                "Gerund l√†m ch·ªß ng·ªØ, kh√¥ng d√πng 'to infinitive'.",
                "V·ªõi 'have finished', question tag l√† 'haven't'.",
                "Sau 'finish' ta d√πng V-ing.",
                "V·ªõi 'will', question tag l√† 'won't'.",
                "Sau 'mind' ta d√πng V-ing.",
                "V·ªõi 'didn't', question tag l√† 'did'.",
                "Gerund l√†m ch·ªß ng·ªØ trong c√¢u.",
                "V·ªõi 'should', question tag l√† 'shouldn't'.",
                "Sau 'keep' ta d√πng V-ing.",
                "V·ªõi 'are', question tag l√† 'aren't'.",
                "Sau 'enjoy' ta d√πng V-ing, v·ªõi gi·ªõi t·ª´ 'to'.",
                "V·ªõi 'wasn't', question tag l√† 'was'.",
                "Gerund l√†m ch·ªß ng·ªØ trong c√¢u.",
                "V·ªõi 'could', question tag l√† 'couldn't'.",
                "Sau t√≠nh t·ª´ s·ªü h·ªØu 'your' ta d√πng V-ing.",
                "V·ªõi 'has been', question tag l√† 'hasn't'.",
                "Sau 'stop' ta d√πng V-ing (d·ª´ng h√†nh ƒë·ªông ƒëang l√†m).",
                "V·ªõi 'wouldn't', question tag l√† 'would'."
            ];
            return explanations[questionIndex] || "H√£y √¥n l·∫°i quy t·∫Øc ng·ªØ ph√°p.";
        }

        function nextGrammarQuestion() {
            if (currentGrammarQuestion < grammarQuestions.length - 1) {
                currentGrammarQuestion++;
                loadGrammarQuestion();
                document.getElementById('grammar-next-btn').classList.add('hidden');
            }
        }

        function previousGrammarQuestion() {
            if (currentGrammarQuestion > 0) {
                currentGrammarQuestion--;
                loadGrammarQuestion();
                document.getElementById('grammar-next-btn').classList.add('hidden');
                document.getElementById('grammar-reset-btn').classList.add('hidden');
            }
        }

        function updateGrammarProgress() {
            const answeredQuestions = currentGrammarQuestion + 1;
            const progressPercent = (answeredQuestions / grammarQuestions.length) * 100;
            document.getElementById('grammar-progress-bar').style.width = progressPercent + '%';
            document.getElementById('grammar-score').textContent = grammarScore;
        }

        function resetGrammarQuiz() {
            currentGrammarQuestion = 0;
            grammarScore = 0;
            grammarCompleted = false;
            loadGrammarQuestion();
            document.getElementById('grammar-next-btn').classList.add('hidden');
            document.getElementById('grammar-reset-btn').classList.add('hidden');
            updateGrammarProgress();
        }

        function checkGrammarCompletion() {
            // This function is no longer needed as completion is handled in selectGrammarAnswer
        }



        // Progress functions
        async function saveProgress(section, itemId, completed, score = 0) {
            if (window.dataSdk) {
                const progressData = {
                    section: section,
                    item_id: itemId,
                    completed: completed,
                    score: score,
                    timestamp: new Date().toISOString()
                };
                
                const result = await window.dataSdk.create(progressData);
                if (result.isOk) {
                    updateProgress();
                }
            }
        }

        function updateProgressFromData(data) {
            // Calculate progress from stored data
            const vocabProgress = vocabLearningStarted ? (learnedCards.size / vocabularyData.length * 100) : 0;
            const readingProgressValue = readingCompleted ? 100 : 0;
            const grammarProgressValue = grammarCompleted ? 100 : 0;
            const totalProgress = (vocabProgress + readingProgressValue + grammarProgressValue) / 3;
            
            updateProgressCircle('vocab-progress', 'vocab-progress-circle', vocabProgress);
            updateProgressCircle('reading-progress', 'reading-progress-circle', readingProgressValue);
            updateProgressCircle('grammar-progress', 'grammar-progress-circle', grammarProgressValue);
            updateProgressCircle('total-progress', 'total-progress-circle', totalProgress);
        }

        function updateProgress() {
            // T√≠nh ti·∫øn ƒë·ªô t·ª´ v·ª±ng d·ª±a tr√™n s·ªë th·∫ª ƒë√£ h·ªçc (ƒë√£ l·∫≠t ho·∫∑c ƒë√£ chuy·ªÉn qua)
            const vocabProgress = vocabLearningStarted ? (learnedCards.size / vocabularyData.length * 100) : 0;
            const readingProgressValue = readingCompleted ? 100 : 0;
            const grammarProgressValue = grammarCompleted ? 100 : 0;
            const totalProgress = (vocabProgress + readingProgressValue + grammarProgressValue) / 3;
            
            updateProgressCircle('vocab-progress', 'vocab-progress-circle', vocabProgress);
            updateProgressCircle('reading-progress', 'reading-progress-circle', readingProgressValue);
            updateProgressCircle('grammar-progress', 'grammar-progress-circle', grammarProgressValue);
            updateProgressCircle('total-progress', 'total-progress-circle', totalProgress);
        }

        function updateProgressCircle(textId, circleId, percentage) {
            const textElement = document.getElementById(textId);
            const circleElement = document.getElementById(circleId);
            
            if (textElement && circleElement) {
                textElement.textContent = Math.round(percentage) + '%';
                const circumference = 226;
                const offset = circumference - (percentage / 100) * circumference;
                circleElement.style.strokeDashoffset = offset;
            }
        }

        // Sound functions
        function playSound(type) {
            // Create audio context for sound effects
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            let frequency;
            let duration;
            
            switch(type) {
                case 'correct':
                    frequency = 800;
                    duration = 0.3;
                    break;
                case 'incorrect':
                    frequency = 300;
                    duration = 0.5;
                    break;
                case 'flip':
                    frequency = 600;
                    duration = 0.1;
                    break;
                case 'next':
                    frequency = 500;
                    duration = 0.1;
                    break;
                case 'prev':
                    frequency = 400;
                    duration = 0.1;
                    break;
                default:
                    frequency = 440;
                    duration = 0.1;
            }
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }

        // Text-to-speech function for vocabulary pronunciation
        function speakWord(word) {
            if ('speechSynthesis' in window) {
                // Cancel any ongoing speech
                window.speechSynthesis.cancel();
                
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                utterance.pitch = 1;
                utterance.volume = 0.8;
                
                // Try to use a native English voice if available
                const voices = window.speechSynthesis.getVoices();
                const englishVoice = voices.find(voice => 
                    voice.lang.startsWith('en') && 
                    (voice.name.includes('Google') || voice.name.includes('Microsoft') || voice.name.includes('Apple'))
                );
                
                if (englishVoice) {
                    utterance.voice = englishVoice;
                }
                
                window.speechSynthesis.speak(utterance);
            }
        }

        // Navigation function
        function goHome() {
            const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
            const homeUrl = config.home_url || defaultConfig.home_url;
            window.open(homeUrl, '_blank', 'noopener,noreferrer');
        }

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99e01cf473e140d9',t:'MTc2MzA1NjI0NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>